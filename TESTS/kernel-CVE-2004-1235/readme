# ConAnalysis

Steps for compiling kernel to bitcode:

0. first compile the whole kernel using "make menuconfig && make"

1. copy all the related files to TESTS/ including header files and .c source code

2. clang -emit-llvm -D __KERNEL__ -O0 -g -c filemap.c -o filemap.bc -I ./include/
Note the option "-D __KERNEL__", which is the key to compile kernel successfully.

3. use "llvm-dis" to generate human-readable LLVM assembly language. 


Some changes in the kernel:

1. include/linux/smp.h:29 Comment this line with "//" at the begining
+ //extern void FASTCALL(smp_send_reschedule(int cpu));

2. include/linux/module.h:370 Delete the word "error"
+ #define EXPORT_SYMBOL(var)     this_object_must_be_defined_as_export_objs_in_the_Makefile
